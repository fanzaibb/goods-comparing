(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{67:function(){},2061:function(){},8345:function(e,n,t){Promise.resolve().then(t.bind(t,5721))},5721:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Home}});var r=t(7437),s=t(1988);t(9398);var a=t(2685),l=t.n(a),i=t(7504),c=t(2265);function Home(){let[e,n]=(0,c.useState)([]),handleMomoUpload=async e=>{let t=e.target.files[0],r=await t.arrayBuffer(),s=i.ij(r),a=s.Sheets[s.SheetNames[0]],l=i.P6.sheet_to_json(a);n(l.map(e=>({id:e["商品編號"],name:e["商品名稱"],cost:e["進價"],price:e["售價(含稅)"],marketPrice:e["市價"]})))},handleFileUpload=async e=>{let t=e.target.files[0],r=await t.arrayBuffer(),s=i.ij(r),a=s.Sheets[s.SheetNames[0]],l=i.P6.sheet_to_json(a);n(e=>{let n=e.map(e=>{let n=l.find(n=>String(n["商品編號"])===e.id);return n?{...e,newName:String(n["商品名稱"]),newCost:String(n["成本"]),newPrice:String(n["定價"]),newMarketPrice:String(n["參考市價(建議售價)"])}:e});return n})};return(0,r.jsxs)("main",{className:l().main,children:[(0,r.jsx)("h1",{className:l().title,children:"今天要吃啥？"}),(0,r.jsxs)("div",{className:l().box,children:[(0,r.jsx)("label",{htmlFor:"item-file",className:l().upload,children:"上傳商品清單"}),(0,r.jsx)("input",{id:"item-file",type:"file",accept:".xlsx, .xls",style:{display:"none"},onChange:handleMomoUpload}),(0,r.jsx)("label",{htmlFor:"momo-file",className:l().upload,children:"上傳MOMO商品內容"}),(0,r.jsx)("input",{id:"momo-file",type:"file",accept:".xlsx, .xls",style:{display:"none"},onChange:handleFileUpload})]}),(0,r.jsx)("div",{children:e.length>0&&(0,r.jsxs)("table",{className:l().table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"編號"}),(0,r.jsx)("th",{children:"名稱"}),(0,r.jsx)("th",{children:"成本"}),(0,r.jsx)("th",{children:"售價"}),(0,r.jsx)("th",{children:"市價"})]})}),(0,r.jsx)("tbody",{children:e.map((e,n)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsxs)("td",{children:[e.name,e.newName&&e.name!==e.newName&&(0,r.jsxs)("span",{style:{color:"red"},children:[" (",e.newName,")"]})]}),(0,r.jsxs)("td",{children:[e.cost,e.newCost&&e.cost!==e.newCost&&(0,r.jsxs)("span",{style:{color:"red"},children:[" (",e.newCost,")"]})]}),(0,r.jsxs)("td",{children:[e.price,e.newPrice&&e.price!==e.newPrice&&(0,r.jsxs)("span",{style:{color:"red"},children:[" (",e.newPrice,")"]})]}),(0,r.jsxs)("td",{children:[e.marketPrice,e.newMarketPrice&&e.marketPrice!==e.newMarketPrice&&(0,r.jsxs)("span",{style:{color:"red"},children:[" ","(",e.newMarketPrice,")"]})]})]},n))})]})})]})}s.vc.autoAddCss=!1},2685:function(e){e.exports={main:"page_main__GlU4n",description:"page_description__86bsR",code:"page_code__9lUUd",grid:"page_grid__f5Kdy",card:"page_card__QV0Om",center:"page_center__5oHG7",logo:"page_logo__7fc9l",content:"page_content__kDoxQ",title:"page_title__3jonF",box:"page_box__nSTsO",red:"page_red__7Jbic",table:"page_table__71QjM",upload:"page_upload__3QSWJ",vercelLogo:"page_vercelLogo__rOY_u",rotate:"page_rotate__durgN"}}},function(e){e.O(0,[425,902,971,472,744],function(){return e(e.s=8345)}),_N_E=e.O()}]);